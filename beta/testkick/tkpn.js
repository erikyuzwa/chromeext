var TestkickPanel=TestkickPanel||{bg:null,getBGPage:function(){var a=chrome.extension.getBackgroundPage();a&&a.TestkickBG?this.bg=a.TestkickBG:(this.bg={recording:!1,config:{apiKey:!1},records:[]},alert("no bg"))},panelInit:function(){var a=this;this.getBGPage();this.setState();$("#record").on("click",function(){a.record()});$("#stop").on("click",function(){a.stop()});$("#enter_key").on("click",function(){a.options()});$("#get_key").on("click",function(){a.new_key()});$("#save").on("click",function(){a.save();
return!1});$("#clear").on("click",function(){a.clear()});$("#open_server").on("click",function(){a.open_server()});$("#help").on("click",function(){a.help()});$("#options").on("click",function(){a.options()})},setState:function(){!0==this.bg.recording?($(".can-record").hide(),$(".can-stop").show()):($(".can-record").show(),$(".can-stop").hide());0<this.bg.records.length?$(".can-save").show():$(".can-save").hide();"undefined"==typeof this.bg.config||this.bg.config&&"undefined"==typeof this.bg.config.apiKey?
$(".can-record").hide():$(".new_installation").hide();$("#recordsCount").text(this.bg.records.length)},record:function(){this.bg.toggleRecord();this.setState()},stop:function(){this.bg.toggleRecord();this.setState()},open_tab:function(a){chrome.tabs.create({url:a},function(a){})},options:function(){this.open_tab(chrome.extension.getURL("tk_opt.html"))},new_key:function(){window.open(this.bg.getUrl("new_key"),"_blank")},open_server:function(){window.open(this.bg.getUrl("main"),"_blank")},help:function(){window.open(this.bg.getUrl("help"),
"_blank")},save:function(){var a=this;this.bg.records&&0!=this.bg.records.length||alert("No Recorded Events To Save");var b=prompt("Please enter a name for this recording");null==b&&(b="Recording "+(new Date).toString());b=this.bg.saveTest(b);b.success(function(b){!1!==b&&"undefined"!=typeof b&&b.id?(a.lastsave=b,!0==confirm("Open Server Page for this test?")&&(a.setState(),window.open(b.url))):alert("Unable to save to server. Please try again")});b.error(function(a){alert("Unable to save to server. Please try again.")});
this.setState()},clear:function(){this.bg.eraseRecords();$("#recordsCount").text(this.bg.records.length);this.setState()}};$(document).ready(function(){TestkickPanel.panelInit()});
